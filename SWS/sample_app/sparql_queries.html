<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SPARQL Queries :: TED Developer Documentation</title>
    <link rel="canonical" href="https://docs.ted.europa.eu/SWS/sample_app/sparql_queries.html">
    <meta name="generator" content="Antora 3.1.2">
    <link rel="stylesheet" href="../../_/css/site.css">
    <link rel="stylesheet" href="../../_/css/custom.css">
    <link rel="stylesheet" href="../../_/css/vendor/docsearch-2.6.3.css">
        <link rel="apple-touch-icon" sizes="180x180" href="../../_/img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../_/img/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../_/img/icons/favicon-16x16.png">
    <link rel="manifest" href="../../_/img/icons/site.webmanifest">
    <link rel="mask-icon" href="../../_/img/icons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="../../_/img/icons/favicon.ico">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="../../_/img/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="9zNtA8Mxo6eMk-CIvQQbCvXFWjOoAHT6phYIK3saIV4" />
    <script>var uiRootPath = '../../_'</script>
  </head>
  <body class="article">
<header class="header">
    <nav class="navbar">
        <div class="navbar-brand">
            <a class="navbar-item" href="https://docs.ted.europa.eu">
                <img src="../../_/img/ted-logo.svg" class="logo" />
                <span class="navbar-title">TED Developer Documentation</span>
            </a>
            <button class="navbar-burger" data-target="topbar-nav">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <div id="topbar-nav" class="navbar-menu">
            <div class="navbar-end">
                <a class="navbar-item" href="https://docs.ted.europa.eu">Home</a>
                <div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">Products</a>
  <div class="navbar-dropdown">
      <a class="navbar-item" href="../../eforms/latest/index.html">eForms SDK</a>
      <a class="navbar-item" href="../../EPO/latest/index.html">eProcurement Ontology</a>
      <a class="navbar-item" href="../../espd/latest/index.html">ESPD EDM</a>
  </div>
</div>


<div class="navbar-item has-dropdown is-hoverable">
  <a class="navbar-link" href="#">Resources</a>
  <div class="navbar-dropdown">
    <!-- <div class="navbar-item"><b>Publications Ofiice</b></div> -->
    <a class="navbar-item" href="https://github.com/OP-TED/eForms-SDK">eForms SDK on Github</a>
    <a class="navbar-item" href="https://simap.ted.europa.eu/web/simap/eforms">eForms on SIMAP</a>
    <a class="navbar-item" href="https://github.com/eprocurementontology/eprocurementontology">eProcurement
      Ontology</a>
    <a class="navbar-item" href="https://github.com/espd/espd-edm">European Single Procurement Document</a>
    <a class="navbar-item" href="https://op.europa.eu/en/web/eu-vocabularies/e-procurement/tables">eProcurement in
      EU Vocabularies</a>
    <hr class="navbar-divider">
    <!-- <div class="navbar-item"><b>DG GROW</b></div>-->
    <a class="navbar-item" href="https://ec.europa.eu/growth/single-market/public-procurement/digital/eforms_en">About
      eForms</a>
    <!-- <a class="navbar-item" href="https://github.com/eForms/eForms">eForms 2nd consultation</a> -->
  </div>
</div>

<a class="navbar-item" href="https://simap.ted.europa.eu/contact">Helpdesk</a>

                <div class="navbar-item search">
                    <input id="search-input" type="text" placeholder="Search docs">
                </div>
            </div>
        </div>
    </nav>
</header>
<div class="body">
<div class="nav-container" data-component="SWS" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">TED Semantic Web Service</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../audience.html">Target Audience</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Mapping suite contents</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../genref.html">General Reference</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/methodology.html">Methodology</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/repository-structure.html">Repository structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/index.html">Mapping suites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/mapping-suite-structure.html">Mapping suite package structure</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/code-list-resources.html">Code list mappings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/preparing-test-data.html">Data samples</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/toolchain.html">Toolchain</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Reusing semantic web service artefacts</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="sa_glossary.html">Glossary</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="sparql_queries.html">SPARQL Queries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="ms_excel.html">MS Excel</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jupyter_notebook_r.html">Jupyter Notebook - R</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="jupyter_notebook_python.html">Jupyter Notebook - Python</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><span class="separated"><strong>Reference</strong></span></span>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../mapping_suite/versioning.html">Versioning</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
      <div class="context">
          <span class="title dim">Select a product/version</span>
          <span class="version">&nbsp;</span>
      </div>
  <ul class="components">
      <li class="component">
        <a class="title" href="../../eforms/latest/index.html">eForms SDK</a>
        <ul class="versions">
            <li class="version is-latest">
              <a href="../../eforms/latest/index.html">1.10.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.9/index.html">1.9.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.8/index.html">1.8.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.7/index.html">1.7.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.6/index.html">1.6.0</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.5/index.html">1.5.1</a>
            </li>
            <li class="version">
              <a href="../../eforms/1.4/index.html">1.4.1</a>
            </li>
        </ul>
      </li>
      <li class="component">
        <a class="title" href="../../EPO/latest/index.html">eProcurement Ontology</a>
        <ul class="versions">
            <li class="version">
              <a href="../../EPO/4.1/index.html">4.1.0-rc.1</a>
            </li>
            <li class="version is-latest">
              <a href="../../EPO/latest/index.html">4.0.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/3.1/index.html">3.1.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/3.0.1/index.html">3.0.1</a>
            </li>
            <li class="version">
              <a href="../../EPO/2.0.1/index.html">2.0.1</a>
            </li>
            <li class="version">
              <a href="../../EPO/2.0.0/index.html">2.0.0</a>
            </li>
            <li class="version">
              <a href="../../EPO/1.0.0/index.html">1.0.0</a>
            </li>
        </ul>
      </li>
      <li class="component">
        <a class="title" href="../../espd/latest/index.html">ESPD EDM</a>
        <ul class="versions">
            <li class="version is-latest">
              <a href="../../espd/latest/index.html">3.3.0</a>
            </li>
        </ul>
      </li>
  </ul>
</div>    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../home/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">TED Semantic Web Service</a></li>
    <li><a href="sparql_queries.html">SPARQL Queries</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="6">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">SPARQL Queries</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In the context of the TED-SWS, SPARQL queries can be used to query  notices data published in RDF by the Publications Office.  These queries can be made on the
<a href="https://publications.europa.eu/webapi/rdf/sparql">SPARQL end point</a> available on EU Vocabularies.</p>
</div>
<div class="paragraph">
<p>SPARQL stands for "SPARQL Protocol and RDF Query Language". SPARQL queries retrieve and manipulate data stored in RDF (Resource Description Framework) format.  It allows users to write complex queries to retrieve specific information from RDF datasets.</p>
</div>
<div class="paragraph">
<p>The data available covers Contract Award Notices published from the 28/08/2023 onwards. Data on eForm Result Notices are not yet available.</p>
</div>
<div class="paragraph">
<p>A query is submitted to the <a href="https://publications.europa.eu/webapi/rdf/sparql">SPARQL end point</a> by replacing the text highlighted below in blue in the Query Text box below with the desired query:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql.png" alt="SPARQL End Point">
</div>
<div class="title">Figure 1. End point user interface</div>
</div>
<div class="paragraph">
<p>The format of the result can be changed using the drop-down box of the Results format.</p>
</div>
<div class="paragraph">
<p>Once the query is in place, and the Results format chosen, the query can be run by pressing “Run Query”.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_examples"><a class="anchor" href="#_examples"></a>Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_query_1_notices_published_by_buyer_on_a_given_date"><a class="anchor" href="#_query_1_notices_published_by_buyer_on_a_given_date"></a>Query 1: Notices published by buyer on a given date</h3>
<div class="paragraph">
<p>This query returns the  notices published by buyer  on a specified date. The data returned are the date, buyer country, buyer name, number of notices. The data is ordered by notice count, descending.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code"><a class="anchor" href="#_query_code"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;

SELECT DISTINCT
?Date
?BuyerCountry
(COALESCE(?BuyerLegalName_en, ?BuyerLegalName_fr, ?BuyerLegalName) AS ?BuyerLegalName)
(COUNT ( DISTINCT ?OJSNumber) as ?NumberOfNotices)

WHERE {

VALUES (?Date) {("20230905")}

?Notice epo:hasPublicationDate ?Date .
?Notice epo:hasID/epo:hasIdentifierValue ?OJSNumber.

?Notice epo:announcesRole ?Agent .
?Agent a epo:Buyer.
?Agent epo:playedBy ?Organization .
?Organization owl:sameAs ?SameAsOrganization.

?SameAsOrganization cccev:registeredAddress / epo:hasCountryCode ?BuyerCountryCode .
bind (replace(str(?BuyerCountryCode),"(^.*[/])(.*)$","$2") as ?BuyerCountry)

OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?BuyerLegalName_en.
      FILTER(LANG(?BuyerLegalName_en) = 'en')
    }
OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?BuyerLegalName_fr.
      FILTER(LANG(?BuyerLegalName_fr) = 'fr')
 }
OPTIONAL {
       ?SameAsOrganization epo:hasLegalName ?BuyerLegalName.
}

}
ORDER BY DESC(?NumberOfNotices) ASC(?BuyerLegalName)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned"><a class="anchor" href="#_data_returned"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q1.png" alt="Q1">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Some cleaning up of the data might be necessary to remove URL strings, (bind (replace(str statements, - to make the information returned more readable.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_2_contracts_awarded_on_a_specific_date"><a class="anchor" href="#_query_2_contracts_awarded_on_a_specific_date"></a>Query 2: Contracts awarded on a specific date</h3>
<div class="paragraph">
<p>This query returns data on the contracts awarded on a specific day.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_2"><a class="anchor" href="#_query_code_2"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;

SELECT DISTINCT
?Date
?OJSNumber
?BuyerCountry

(COALESCE(?BuyerLegalName_en, ?BuyerLegalName_fr, ?BuyerLegalName) AS ?BuyerLegalName)

WHERE {

VALUES (?Date) {("20230905")}

?Notice epo:hasPublicationDate ?Date .
?Notice epo:hasID/epo:hasIdentifierValue ?OJSNumber.

?Notice epo:announcesRole ?Agent .
?Agent a epo:Buyer.
?Agent epo:playedBy ?Organization .
?Organization owl:sameAs ?SameAsOrganization.

?SameAsOrganization epo:hasLegalName ?BuyerLegalName.
?SameAsOrganization cccev:registeredAddress / epo:hasCountryCode ?BuyerCountryCode .
bind (replace(str(?BuyerCountryCode),"(^.*[/])(.*)$","$2") as ?BuyerCountry)

OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?BuyerLegalName_en.
      FILTER(LANG(?BuyerLegalName_en) = 'en')
}
OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?BuyerLegalName_fr.
      FILTER(LANG(?BuyerLegalName_fr) = 'fr')
}
OPTIONAL {
        ?SameAsOrganization epo:hasLegalName ?BuyerLegalName.
}
}
ORDER BY DESC(?BuyerLegalName)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_2"><a class="anchor" href="#_data_returned_2"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q2.png" alt="Q2">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The values shown are only those at the beginning of a much longer list in different currencies (in alphabetic order). The others e.g., euros, follow. To get comparable values, all currencies will need to be converted to euros (or the same currency) manually.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_3_the_highest_value_contract_award_published_for_a_specific_date_by_currency_full_data"><a class="anchor" href="#_query_3_the_highest_value_contract_award_published_for_a_specific_date_by_currency_full_data"></a>Query 3: The highest value contract award published for a specific date by currency (full data)</h3>
<div class="paragraph">
<p>This query returns the contracts awarded on a specific data in descending order of value per currency.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_3"><a class="anchor" href="#_query_code_3"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;

SELECT DISTINCT
?Date
?OJSNumber
?Lot
?WinnerLegalName_en
?WinnerLegalName_fr
(COALESCE(?WinnerLegalName_en, ?WinnerLegalName_fr, ?WinnerLegalName) AS ?WinnerLegalName)
?WinnerCountry
?Lot_AwardedValue
?Currency

WHERE {

 VALUES (?Date ) {("20230905")}

?Notice epo:hasPublicationDate ?Date ;
        epo:hasID/epo:hasIdentifierValue ?OJSNumber ;
        epo:announcesContract/epo:includesLot ?Lot .

?LotAwardOutcome epo:describesLot ?Lot ;
                 epo:comprisesTenderAwardOutcome/epo:indicatesAwardOfLotToWinner ?Winner;
                 epo:hasAwardedValue ?LotAwardedValueURI .

?Winner epo:playedBy ?Organization .
?Organization owl:sameAs ?SameAsOrganization.
?SameAsOrganization cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode .
  bind (replace(str(?WinnerCountryCode),"(^.*[/])(.*)$","$2") as ?WinnerCountry)

?SameAsOrganization epo:hasLegalName ?WinnerLegalName.
OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?WinnerLegalName_en.
      FILTER(LANG(?WinnerLegalName_en) = 'en')
}
OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?WinnerLegalName_fr.
      FILTER(LANG(?WinnerLegalName_fr) = 'fr')
}
OPTIONAL {
        ?SameAsOrganization epo:hasLegalName ?WinnerLegalName.
}

?LotAwardedValueURI epo:hasAmountValue ?LotAwardedValue ;
                    epo:hasCurrency ?LotAwardedValueCurrency.
bind( FLOOR(?LotAwardedValue) as ?Lot_AwardedValue).
bind (replace(str(?LotAwardedValueCurrency),"(^.*[/])(.*)$","$2") as ?Currency)

}
ORDER BY ASC(?LotAwardedValueCurrency) DESC(?LotAwardedValue)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_3"><a class="anchor" href="#_data_returned_3"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q3.png" alt="Q3">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The data contains all the currencies used in the EU arranged alphabetically (only the beginning of the list is shown here). For a true comparison, all currencies will need to be converted to the same one.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_4_count_of_notices_awarded_on_a_specific_date_where_the_economic_operator_foresees_subcontracting"><a class="anchor" href="#_query_4_count_of_notices_awarded_on_a_specific_date_where_the_economic_operator_foresees_subcontracting"></a>Query 4: Count of notices awarded on a specific date where the economic operator foresees subcontracting</h3>
<div class="paragraph">
<p>This query returns the count of the winning economic operator where the operator foresees subcontracting to other organisations. The data is displayed as a simple count.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_4"><a class="anchor" href="#_query_code_4"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;

SELECT COUNT(DISTINCT ?Tender) as ?NrOfTenders

WHERE {

   VALUES (?Date ) {("20230905")}

   ?Notice epo:hasPublicationDate ?Date .
   ?Notice epo:refersToLot ?Lot .
   ?Tender epo:isSubmittedForLot ?Lot .
   ?Tender epo:foreseesSubcontracting ?Subcontrating .
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_4"><a class="anchor" href="#_data_returned_4"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q4.png" alt="Q4">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
NOTE: This data may not be complete or accurate as this information may change during provision.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_5_notices_awarded_on_a_specific_date_where_the_economic_operator_foresees_subcontracting"><a class="anchor" href="#_query_5_notices_awarded_on_a_specific_date_where_the_economic_operator_foresees_subcontracting"></a>Query 5: Notices awarded on a specific date where the economic operator foresees subcontracting</h3>
<div class="paragraph">
<p>This query returns a list of the winning economic operator where the operator foresees subcontracting to other organisations. The data is displayed in columns.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_5"><a class="anchor" href="#_query_code_5"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;

SELECT DISTINCT
?Date
?OJSNumber
?Notice_Lot
?Forsees_subcontracting

WHERE {

   VALUES (?Date ) {("20230905")}

   ?Notice epo:hasPublicationDate ?Date.
   ?Notice  epo:hasID/epo:hasIdentifierValue ?OJSNumber.
   ?Notice epo:refersToLot ?Lot .
   ?Tender epo:isSubmittedForLot ?Lot .
   OPTIONAL{?Tender epo:foreseesSubcontracting ?SC .}

bind (replace(str(?Lot),"http://data.europa.eu/a4g/resource/id_","") as ?Notice_Lot)
bind (replace(str(?SC),"http://data.europa.eu/a4g/resource/id_","") as ?Forsees_subcontracting)
FILTER (?Forsees_subcontracting != "" )
}
ORDER BY ASC(?OJSNumber) ASC(?Lot)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_5"><a class="anchor" href="#_data_returned_5"></a>Data  Returned</h3>
<div class="paragraph">
<p>(To enlarge the image, right-click on it and choose "Open image in new tab")</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q5.png" alt="Q5">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
NOTE: This data may not be complete or accurate as this information may change during provision.
</td>
</tr>
</table>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_6_the_number_of_economic_operators_awarded_contracts_on_a_specific_date_that_are_smes"><a class="anchor" href="#_query_6_the_number_of_economic_operators_awarded_contracts_on_a_specific_date_that_are_smes"></a>Query 6: The number of economic operators awarded contracts on a specific date that are SMEs</h3>
<div class="paragraph">
<p>The data returned are the country and the count per country, displayed by count, descending.</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_6"><a class="anchor" href="#_query_code_6"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;

SELECT
?WinnerCountry
(COUNT( DISTINCT ?WinnerLegalName) as ?NrOfSmeWinners)

WHERE {
SELECT
?WinnerCountry
(COALESCE(?WinnerLegalName_en, ?WinnerLegalName_fr, ?WinnerLegalName) AS ?WinnerLegalName)

    WHERE {

    VALUES (?Date ?Business_Size) {
    (
    "20230905"
    &lt;http://publications.europa.eu/resource/authority/economic-operator-size/sme&gt;
    )
    }

    ?Notice epo:hasPublicationDate ?Date .

    ?Notice epo:announcesRole ?Agent .
    ?Agent a epo:Winner.
    ?Agent epo:playedBy ?Organization .
    ?Organization owl:sameAs ?SameAsOrganization.

    ?SameAsOrganization epo:hasBusinessSize ?Business_Size .
    ?SameAsOrganization cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode .
     bind (replace(str(?WinnerCountryCode),"(^.*[/])(.*)$","$2") as ?WinnerCountry)

     OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?WinnerLegalName_en.
      FILTER(LANG(?WinnerLegalName_en) = 'en')
    }
    OPTIONAL {
      ?SameAsOrganization epo:hasLegalName ?WinnerLegalName_fr.
      FILTER(LANG(?WinnerLegalName_fr) = 'fr')
    }
    OPTIONAL {
       ?SameAsOrganization epo:hasLegalName ?WinnerLegalName.
    }
    }
}
ORDER BY DESC (?NrOfSmeWinners)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_6"><a class="anchor" href="#_data_returned_6"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q6.png" alt="Q6">
</div>
</div>
<hr>
</div>
<div class="sect2">
<h3 id="_query_7_the_list_of_economic_operators_awarded_contracts_on_a_specific_date_that_are_smes"><a class="anchor" href="#_query_7_the_list_of_economic_operators_awarded_contracts_on_a_specific_date_that_are_smes"></a>Query 7: The list of economic operators awarded contracts on a specific date that are SMEs</h3>
<div class="paragraph">
<p>The data returned are data, ojs-number, operator name, operator country, and business size displayed in alphabetic order by country..</p>
</div>
</div>
<div class="sect2">
<h3 id="_query_code_7"><a class="anchor" href="#_query_code_7"></a>Query Code</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-sparql hljs" data-lang="sparql">PREFIX epo: &lt;http://data.europa.eu/a4g/ontology#&gt;
PREFIX cccev: &lt;http://data.europa.eu/m8g/&gt;
PREFIX owl: &lt;http://www.w3.org/2002/07/owl#&gt;

SELECT DISTINCT
?Date
?OJSNumber
?Organization
?SameAsOrganization
?WinnerLegalName_en
?WinnerLegalName_fr
(COALESCE(?WinnerLegalName_en, ?WinnerLegalName_fr, ?WinnerLegalName) AS ?WinnerLegalName)
?WinnerCountry
?BusinessSize

WHERE {

VALUES (?Date ) {("20230905")}

?Notice epo:hasPublicationDate ?Date .
?Notice epo:hasID/epo:hasIdentifierValue ?OJSNumber.

?Notice epo:announcesRole ?Agent .
?Agent a epo:Winner.
?Agent epo:playedBy ?Organization .
?Organization owl:sameAs ?SameAsOrganization.

 ?SameAsOrganization cccev:registeredAddress / epo:hasCountryCode ?WinnerCountryCode .
 bind (replace(str(?WinnerCountryCode),"(^.*[/])(.*)$","$2") as ?WinnerCountry)

OPTIONAL {
?SameAsOrganization epo:hasLegalName ?WinnerLegalName_en.
FILTER(LANG(?WinnerLegalName_en) = 'en')
}
OPTIONAL {
?SameAsOrganization epo:hasLegalName ?WinnerLegalName_fr.
FILTER(LANG(?WinnerLegalName_fr) = 'fr')
}
OPTIONAL {
?SameAsOrganization epo:hasLegalName ?WinnerLegalName.
}

OPTIONAL {
?SameAsOrganization epo:hasBusinessSize ?Business_Size .
bind (replace(str(?Business_Size),"(^.*[/])(.*)$","$2") as ?BusinessSize)
}

}
ORDER BY ASC (?WinnerCountry) DESC (?WinnerLegalName)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_data_returned_7"><a class="anchor" href="#_data_returned_7"></a>Data  Returned</h3>
<div class="imageblock">
<div class="content">
<img src="../_images/sparql/Q7.png" alt="Q7">
</div>
</div>
<hr>
<div class="paragraph">
<p>Any comments on the documentation?</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/OP-TED/ted-rdf-docs/issues/new/choose">Click here to let us know</a></p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/docsearch-2.6.3.js"></script>
<script src="../../_/js/vendor/search-algolia.js" id="search-script" data-api-key="7bd6f4bbe2cb3188cd99f1625cb00f75" data-api-id="BE8MR7O2G7" data-index-name="ted-docs-idx"></script>
<footer class="footer">
    <div class=columns>
        <div>
  <p>The projects documented in this Developer Documentation Portal are developed and managed by the TED & EU Public Procurement Unit of the Publications Office of the European Union
  <br/>This page was built using a link:https://github.com/OP-TED/antora-eui[fork of the Antora default UI], which is licensed under the terms of the MPL-2.0 license.</p>
</div>
        <div>
            <h3>This website is managed by<h3>
                    <img src="../../_/img/op-logo-with-name.svg" class="logo" />
        </div>
    </div>
</footer>  </body>
</html>
